<!DOCTYPE html>
<html>
<head>
  <title>Upload Homework</title>
  <!-- Include Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <style>
    body {
      font-family: "Lato", sans-serif;
      text-align: center;
    }
    h1 {
      color: red; /* Change the text color to red */
    }
    /* Additional styles for the file upload form */
    .upload-form {
      margin-top: 50px;
      max-width: 400px;
      margin: 50px auto;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 5px;
      box-shadow: 0 0 5px #ccc;
    }
    .upload-form label {
      display: block;
      margin-bottom: 10px;
      font-size: 18px;
      color: #333;
    }
    .upload-form input[type="file"] {
      margin-bottom: 10px;
    }
    .upload-form input[type="submit"] {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .upload-form input[type="submit"]:hover {
      background-color: #45a049;
    }
  </style>
  <script>
    // Your Firebase configuration object
    var firebaseConfig = {
      apiKey: "AIzaSyAqL2Qw8PMsvF_68VlNxCaKKt9ldTClbP4",
      authDomain: "upload-372ff.firebaseapp.com",
      projectId: "upload-372ff",
      storageBucket: "upload-372ff.appspot.com",
      messagingSenderId: "967062218795",
      appId: "1:967062218795:web:083e9c6a2ebdf2b7d8626e",
      measurementId: "G-VBJ93FPBJ5"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    // Get a reference to Firestore
    var db = firebase.firestore();

    // Function to handle file upload
    function saveUploadedFiles() {
      const fileInput = document.getElementById("homeworkFiles");
      const files = fileInput.files;

      // Reference to Firebase Cloud Storage
      var storageRef = firebase.storage().ref();

      // Loop through the selected files and upload them to Firebase Storage
      for (let i = 0; i < files.length; i++) {
        const file = files[i];
        const uniqueSuffix = Date.now() + "-" + Math.round(Math.random() * 1e9);
        const fileName = "homework-" + uniqueSuffix + "-" + file.name;

        // Upload the file to Firebase Storage
        var fileRef = storageRef.child(fileName);
        fileRef.put(file).then(function(snapshot) {
          console.log("File uploaded successfully!");

          // Save the file metadata to Firestore
          db.collection("uploadedFiles").doc(fileName).set({
            name: file.name,
            fullPath: snapshot.metadata.fullPath
          }).then(function() {
            console.log("File metadata saved to Firestore!");
          }).catch(function(error) {
            console.error("Error saving file metadata to Firestore:", error);
          });
        }).catch(function(error) {
          console.error("Error uploading file:", error);
        });
      }
    }
  </script>
</head>
<body>
  <h1>Upload Homework</h1>
  <div class="upload-form">
    <form onsubmit="saveUploadedFiles()" enctype="multipart/form-data">
      <label for="homeworkFiles">Select Homework Files:</label>
      <input type="file" id="homeworkFiles" name="homeworkFiles[]" accept=".pdf, .doc, .docx, .txt" multiple>
      <br>
      <input type="submit" value="Upload Homework">
    </form>
  </div>
  <a href="/index.html">Go Back to Home</a>
</body>
</html>
